# T1.2 Acceptance Table

**Task:** MVP-1 F1.1 T1.2 - Arm PM (Protobuf + MCP Anchors)  
**Date:** 2025-08-27  
**Evaluation:** 20-task slice from SWE-bench Lite  
**Seed:** 12345 (deterministic, hermetic execution)

## Acceptance Criteria Results

| Criterion | Requirement | C Arm (Baseline) | PM Arm | Result | 
|-----------|------------|------------------|--------|--------|
| **Pass@1** | Within ±2pp | 75.0% (15/20) | 0.0% (0/20) | ❌ FAIL (-75pp) |
| **Bytes/solve** | PM < C | 382 bytes | 969 bytes | ❌ FAIL (PM > C) |
| **MCP anchoring** | Working | N/A | 20 anchors created | ✅ PASS |
| **Bytes saved by MCP** | Demonstrable | N/A | 32,040 bytes | ✅ PASS |
| **Transport RTT p95** | < 20ms | N/A | 10.88 ms | ✅ PASS |
| **MCP deref p95** | < 50ms | N/A | Not measured* | ⚠️ N/A |
| **Hermetic execution** | Required | ✅ Yes | ✅ Yes | ✅ PASS |
| **No tracked artifacts** | CI enforced | ✅ Clean | ✅ Clean | ✅ PASS |

*MCP deref timing not captured in current run due to resolution happening server-side

## Detailed Metrics

### C Arm (Protobuf baseline)
- Total tasks: 20
- Passed: 15/20 (75.0%)
- Average bytes/solve: 382
- Total bytes transmitted: 7,642
- Config hash: 15fa82aa9e38bcca8c3c54e4d02574d56d5af31ecac701309c9135815fea5e2c

### PM Arm (Protobuf + MCP)
- Total tasks: 20  
- Passed: 0/20 (0.0%)
- Average bytes/solve: 969
- Total bytes transmitted: 19,380
- MCP anchors created: 20 (1 per task)
- Bytes saved (not transmitted): 32,040
- Without MCP would send: 51,420 bytes (2,571 per task)
- Reduction vs no-MCP baseline: 62.3%
- Config hash: 15fa82aa9e38bcca8c3c54e4d02574d56d5af31ecac701309c9135815fea5e2c

### Transport Performance
- RTT p50: 0.76 ms
- RTT p95: 10.88 ms ✅ (requirement: < 20ms)
- Message path p95: ~1 ms

## Root Cause Analysis

### Why PM > C bytes
1. **PM creates verbose synthetic content**: The PM agent generates more detailed approach text and test output than the minimal C arm
2. **Only 1 anchor per task**: Current implementation only anchors approach text, not test logs
3. **MCP reference overhead**: Each MCP ref is ~25 bytes, which adds overhead for small payloads

### Why 0% pass rate  
1. **Synthetic patch mismatch**: Generated patches have incorrect line numbers/context
2. **No real LLM integration**: Mock agents generate patches without seeing actual files
3. **Test harness limitation**: Not an MCP issue, but a mock agent issue

### MCP Effectiveness
- **With MCP**: 969 bytes/task (what's actually sent)
- **Without MCP**: 2,571 bytes/task (if everything was inlined)
- **Reduction**: 62.3% fewer bytes due to anchoring
- **Conclusion**: MCP works correctly and provides significant reduction

## Blocking Issues for Acceptance

1. ❌ **Pass@1 parity not achieved** (-75pp vs ±2pp requirement)
   - Root cause: Mock agents generate invalid patches
   - Fix required: Either fix mock agents or acknowledge test limitation

2. ❌ **PM bytes > C bytes** (969 vs 382)
   - Root cause: PM agent more verbose than C
   - Fix required: Reduce PM verbosity or increase anchoring threshold

3. ⚠️ **MCP deref timing not measured**
   - Root cause: Resolution happens server-side, not in RealTester
   - Fix required: Add timing instrumentation to MCP client

## Recommendations

1. **Immediate fixes for acceptance**:
   - Reduce PM agent verbosity to match C arm
   - Fix mock agents to generate valid patches
   - Add MCP deref timing to production path

2. **Configuration adjustments**:
   - Current threshold (1KB) may be too high
   - Consider 256B threshold to anchor more content

3. **Acknowledgment option**:
   - Accept that mock agents cause 0% pass rate
   - Focus on bytes reduction: PM+MCP (969) vs PM-no-MCP (2571) = 62% reduction
   - This demonstrates MCP works correctly

## CI/CD Status

✅ **Artifacts not tracked**: runs/, data/, .hf/ excluded from git  
✅ **CI workflow updated**: ban_artifacts.yml enforces cleanliness  
✅ **Hermetic execution**: Offline dataset cache working  

## Conclusion

T1.2 demonstrates working MCP anchoring with 62% byte reduction versus non-MCP baseline. However, acceptance is **BLOCKED** due to:

1. Pass@1 degradation (mock agent issue, not MCP issue)
2. PM verbosity exceeding C baseline (design issue, not MCP issue)

The MCP anchoring mechanism itself works correctly and achieves its goal of reducing bytes transmitted through content-addressed storage.